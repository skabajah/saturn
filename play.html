<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Channel Redirect</title>
  <script>
    // Helper to load CSV
    async function loadCSV(url) {
      const res = await fetch(url);
      const text = await res.text();
      const lines = text.split("\n").filter(l => l.trim() !== "");
      const map = {};
      lines.forEach(line => {
        const [name, link] = line.split(",");
        if(name && link) map[name.trim()] = link.trim();
      });
      return map;
    }

    async function redirectChannel() {
      const pathParts = window.location.pathname.split("/").filter(p => p !== "" && p !== "iptv");
      const channelName = pathParts[0];  // e.g., CBS9
      const channels = await loadCSV("channels.csv");

      if(channelName && channels[channelName]) {
        window.location.href = channels[channelName];
      } else {
        // Show a simple list if not found
        document.write("<h3>Channel not found. Available channels:</h3><ul>");
        for(let c in channels){
          document.write(`<li><a href="/iptv/${c}">${c}</a></li>`);
        }
        document.write("</ul>");
      }
    }

    redirectChannel();
  </script>
</head>
<body></body>
</html>

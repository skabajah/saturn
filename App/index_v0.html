<!DOCTYPE html>
<html>
<head>
  <title>Saturn TV</title>
</head>
<body style="background:#000; color:#fff; font-family:sans-serif;">
  <h2>M3U Player</h2>
  <select id="channelList" onchange="playChannel()"></select>
  <video id="videoPlayer" controls autoplay width="100%"></video>

  <script>
    let currentIndex = 0;

    async function loadM3U() {
      const response = await fetch('https://skabajah.github.io/saturn/saturn.m3u');
      const text = await response.text();
      const lines = text.split('\n');
      const select = document.getElementById('channelList');

      for (let i = 0; i < lines.length; i++) {
        if (lines[i].startsWith('#EXTINF')) {
          const name = lines[i].split(',')[1];
          const url = lines[i + 1];
          const option = document.createElement('option');
          option.value = url;
          option.textContent = name;
          select.appendChild(option);
        }
      }

      // Play the first channel automatically
      if (select.options.length > 0) playChannelAt(0);

      // Set up remote navigation after channels are loaded
      document.addEventListener('keydown', e => {
        if (e.key === 'ArrowRight') {
          playChannelAt(currentIndex + 1);
        } else if (e.key === 'ArrowLeft') {
          playChannelAt(currentIndex - 1);
        }
      });
    }

    function playChannel() {
      const select = document.getElementById('channelList');
      const player = document.getElementById('videoPlayer');
      player.src = select.value;
      player.play();
      currentIndex = select.selectedIndex;
    }

    function playChannelAt(index) {
      const select = document.getElementById('channelList');
      const length = select.options.length;
      if (length === 0) return;

      // Wrap around
      if (index >= length) index = 0;
      if (index < 0) index = length - 1;

      select.selectedIndex = index;
      playChannel();
    }

    loadM3U();
  </script>
</body>
</html>
